---
title: "coexpression-eqtls"
author: "em"
date: "December 27, 2019"
output:
  html_document:
    keep_md: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
setwd('~/Documents/capsella-eqtl/')
library(dplyr)

```

### Make Gemma Input files

Bim and bam files
```{bash, eval=F}
##scaf1_8.map and scaf1_8.ped generated by YWL
plink --noweb --file ../data/gemma/scaf1_8 --keep ../data/gemma/146_DNA_names_forplink --recode --out ../data/gemma/trans146 
plink --noweb --file ../data/gemma/trans146 --make-bed --out ../data/gemma/t146 

```




Make the fam file for gemma:
```{r}
tfam = read.table('data/gemma-files/t146.fam', stringsAsFactors = F)

inlist = read.table('data/id-list', stringsAsFactors = F, header=T)

#stick fam names onto the normalized iegenvectors
namemerge = dplyr::left_join(nEigens, namecol, by="DNA_short.name")
allmerge = dplyr::left_join(myfam, namemerge, by = c('V2' = "DNA_vcfname"))

newfam = allmerge[,c(1:5, 31:45)]
write.table(newfam, file = 'data/batched.fam', row.names=F, col.names=F, quote=F)

```